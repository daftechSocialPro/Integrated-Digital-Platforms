<main id="main" class="main">
    <div class="pagetitle">
        <h1>Performance Report </h1>
        <nav>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a routerLink="/">Home</a></li>
                <li class="breadcrumb-item active">Plan Report </li>
            </ol>
        </nav>
    </div>
    <section class="section dashboard">


        <div class="card">

            <div class="col-lg-4 p-4">
                <label for="filterOption" class="form-label">Filter Option:</label>
                <select id="filterOption" class="form-control" [(ngModel)]="selectedFilterOption" (change)="filterTable()">
                  <option value="all">All</option>
                  <option value="weekly">Weekly</option>
                  <option value="monthly">Monthly</option>
                </select>
              </div>
        </div>
        
        <div class="card">
            <p-table #dt [value]="filterdPlans" rowGroupMode="rowspan" groupRowsBy="responsible"
                sortField="responsible" sortMode="single" [tableStyle]="{'min-width': '75rem'}">
                <ng-template pTemplate="caption">
                    <div class="flex">
                        <button type="button" pButton pRipple icon="pi pi-file-excel" (click)="exportExcel()" class="p-button-success mr-2" pTooltip="XLS" tooltipPosition="bottom"></button> &nbsp;
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th style="width:3rem">S.N</th>
                        
                        <th>Activity</th>
                        <th>Place Of Work</th>
                        <th>From Date</th>
                        <th>To Date</th>
                        <th>Responsible</th>
                        <th>Work Status</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-acts let-rowIndex="rowIndex" let-rowgroup="rowgroup"
                    let-rowspan="rowspan">
                    <tr>
                        <td>{{rowIndex + 1}}</td>
                     
                        <td>
                            {{acts.activity}}
                        </td>
                        <td>
                            {{acts.placeOfWork}}
                        </td>
                        <td>
                            {{acts.fromDate | date : 'dd, MMMM, yyyy'}}
                        </td>
                        <td>
                            {{acts.toDate | date : 'dd, MMMM, yyyy'}}
                        </td>
                        <td >
                            {{acts.employeeName}}
                        </td>
                        <td>
                            {{acts.workStatus}}
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </section>
</main>