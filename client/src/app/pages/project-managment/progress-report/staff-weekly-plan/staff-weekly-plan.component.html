<main id="main" class="main">
    <div class="pagetitle">
        <h1>Performance Report </h1>
        <nav>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a routerLink="/">Home</a></li>
                <li class="breadcrumb-item active">Plan Report </li>
            </ol>
        </nav>
    </div>
    <section class="section dashboard">


        <div class="card">

            <div class="col-12">
                    <p-calendar [(ngModel)]="rangeDates"  selectionMode="range" [readonlyInput]="true"></p-calendar> &nbsp;
                    <button type="button" pButton pRipple lable="Find" icon="pi pi-search" (click)="Search()" class="mr-2"></button> 
            </div>
        </div>
        
        <div class="card">
            <p-table #dt [value]="staffWeeklyPlanDto" rowGroupMode="rowspan" groupRowsBy="responsible"
                sortField="responsible" sortMode="single" [tableStyle]="{'min-width': '75rem'}">
                <ng-template pTemplate="caption">
                    <div class="flex">
                        <button type="button" pButton pRipple icon="pi pi-file-excel" (click)="exportExcel()" class="p-button-success mr-2" pTooltip="XLS" tooltipPosition="bottom"></button> &nbsp;
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th style="width:3rem">S.N</th>
                        <th>Activity Number</th>
                        <th>Activity</th>
                        <th>Place Of Work</th>
                        <th>Execution Date</th>
                        <th>Responsible</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-acts let-rowIndex="rowIndex" let-rowgroup="rowgroup"
                    let-rowspan="rowspan">
                    <tr>
                        <td>{{rowIndex + 1}}</td>
                        <td>
                            {{acts.activityNo}}
                        </td>
                        <td>
                            {{acts.activity}}
                        </td>
                        <td>
                            {{acts.placeOfWork}}
                        </td>
                        <td>
                            {{acts.executionDate | date : 'dd, MMMM, yyyy'}}
                        </td>
                        <td *ngIf="rowgroup" [attr.rowspan]="rowspan">
                            {{acts.responsible}}
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </section>
</main>