import { Component } from '@angular/core';
import { DomSanitizer } from '@angular/platform-browser';
import { ActivatedRoute } from '@angular/router';
import { PayeeDetailListsDto, PaymentLetterDto } from 'src/app/model/Finance/IPaymentDto';
import { FinanceService } from 'src/app/services/finance.service';
// import { logo2 } from './logo2.png'


@Component({
  selector: 'app-payment-transfer',
  templateUrl: './payment-transfer.component.html',
  styleUrls: ['./payment-transfer.component.scss']
})
export class PaymentTransferComponent {

  imagePath: string = 'https://emwamms.org/assets/logo2.png';
  stampImg: string = "data:image/jpeg;base64,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"


  paymentLetter: PaymentLetterDto  = {
    accountNumber : " ",
    ammountInWords : " ",
    approver: " ",
    approverPosition: " ",
    authorizer : " ",
    authorizerPosition: " ",
    bankAddress: " ",
    bankName: " ",
    branchName: " ",
    receiver: " ",
    reciverAccountNumber: " ",
    totalAmmount: 0
  }
  payeeDetails:PayeeDetailListsDto[]=[]


  constructor(private financeService: FinanceService,
    private route: ActivatedRoute,
    public sanitizer: DomSanitizer) { }

    ngOnInit(): void {
      let paymentId = this.route.snapshot.queryParamMap.get('paymentId')?.toString();
      if (paymentId) {
        this.financeService.getPaymentLetter(paymentId).subscribe({
          next: (res) => {
            this.paymentLetter = res;
            this.getPayeeDetails(paymentId)
          }
        });
      
      }
    }


    getPayeeDetails(paymentId:string) {
      this.financeService.getPayeeDetails(paymentId).subscribe({
        next: (res) => {
          this.payeeDetails = res;
          setTimeout(() => {
            this.print();
          },
            2000);
        },
      });
    }
    
    print(){
      let printContents: any;
      printContents = document.getElementById('paymentLetter')?.innerHTML;
      const originalContents = document.body.innerHTML;
      document.body.innerHTML = printContents;
      window.print();
    }

}
